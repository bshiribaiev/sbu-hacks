{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/shiribaiev/Library/CloudStorage/GoogleDrive-bekbolnyc%40gmail.com/My%20Drive/Coding/sbu-hacks/renderer/app/api/scenes/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport fs from 'fs'\nimport path from 'path'\n\nexport async function GET() {\n  try {\n    const modelsDir = path.join(process.cwd(), 'public', 'models')\n    const scenes: any[] = []\n    const parentScenes = new Map<string, number>() // Map folder name to parent scene ID\n    \n    // Helper to format scene name\n    const formatName = (name: string) => {\n      return name.replace('.glb', '').replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())\n    }\n    \n    // Read root level files\n    const rootFiles = fs.readdirSync(modelsDir, { withFileTypes: true })\n    \n    // First pass: Add all parent scenes\n    for (const item of rootFiles) {\n      if (item.isFile() && item.name.endsWith('.glb')) {\n        // Root level GLB files are parent scenes\n        const sceneName = formatName(item.name)\n        scenes.push({\n          id: scenes.length + 1,\n          name: sceneName,\n          fileName: item.name,\n          folder: '',\n          description: `${sceneName} scene reconstruction.`,\n          parentId: null,\n        })\n      } else if (item.isDirectory()) {\n        // Each folder represents a parent scene\n        const folderName = item.name\n        const folderPath = path.join(modelsDir, folderName)\n        const folderFiles = fs.readdirSync(folderPath)\n        \n        // Find the parent scene file (matches folder name)\n        const parentFile = folderFiles.find(f => f === `${folderName}.glb`)\n        let parentSceneName = formatName(folderName)\n        \n        // Override specific scene names\n        if (folderName === 'room') {\n          parentSceneName = 'Dorm Room Death'\n        }\n        \n        if (parentFile) {\n          // Add parent scene\n          const parentId = scenes.length + 1\n          scenes.push({\n            id: parentId,\n            name: parentSceneName,\n            fileName: parentFile,\n            folder: folderName,\n            description: `${parentSceneName} scene reconstruction.`,\n            parentId: null,\n          })\n          parentScenes.set(folderName, parentId)\n        }\n      }\n    }\n    \n    // Second pass: Add child scenes\n    for (const item of rootFiles) {\n      if (item.isDirectory()) {\n        const folderName = item.name\n        const folderPath = path.join(modelsDir, folderName)\n        const folderFiles = fs.readdirSync(folderPath)\n        const parentSceneId = parentScenes.get(folderName)\n        \n        if (parentSceneId) {\n          // Add child scenes (files that don't match folder name)\n          folderFiles.forEach((file) => {\n            if (file.endsWith('.glb') && file !== `${folderName}.glb`) {\n              const childName = formatName(file)\n              const parentSceneName = formatName(folderName)\n              \n              // Check if this child already exists (might be in multiple folders)\n              const existingChild = scenes.find(s => s.fileName === file && s.parentIds)\n              \n              if (existingChild) {\n                // Add this parent to the existing child's parentIds\n                if (!existingChild.parentIds.includes(parentSceneId)) {\n                  existingChild.parentIds.push(parentSceneId)\n                }\n              } else {\n                // Create new child scene\n                scenes.push({\n                  id: scenes.length + 1,\n                  name: childName,\n                  fileName: file,\n                  folder: folderName,\n                  description: `${childName} detail from ${parentSceneName}.`,\n                  parentIds: [parentSceneId],\n                })\n              }\n            }\n          })\n        }\n      }\n    }\n    \n    return NextResponse.json({ scenes })\n  } catch (error) {\n    console.error('Error scanning scenes:', error)\n    return NextResponse.json({ error: 'Failed to scan scenes' }, { status: 500 })\n  }\n}\n\n"],"names":[],"mappings":"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","debugId":null}}]
}